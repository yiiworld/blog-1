<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Yii1 | forecho]]></title>
  <link href="http://blog.forecho.com/categories/yii1/atom.xml" rel="self"/>
  <link href="http://blog.forecho.com/"/>
  <updated>2016-07-08T02:14:06+00:00</updated>
  <id>http://blog.forecho.com/</id>
  <author>
    <name><![CDATA[forecho]]></name>
    <email><![CDATA[caizhenghai@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[使用Yii的 CMenu]]></title>
    <link href="http://blog.forecho.com/shi-yong-yiide-cmenu.html"/>
    <updated>2014-11-17T04:51:47+00:00</updated>
    <id>http://blog.forecho.com/shi-yong-yiide-cmenu</id>
    <content type="html"><![CDATA[<p><code>php
$this-&gt;widget('zii.widgets.CMenu',array(
    'activeCssClass'=&gt;'当前热点元素的样式',
    'firstItemCssClass'=&gt;'第一个元素的样式',
    'lastItemCssClass'=&gt;'最后一个元素的样式',
    'htmlOptions'=&gt;array('class'=&gt;'默认样式'),
    'items'=&gt;array(
        array(
            'label'=&gt;'网站概况',
            'url'=&gt;array('/admin'),
            'itemOptions'=&gt;array(
                'class'=&gt;'li_status'
            ),
            'active'=&gt;$this-&gt;id=='admin'?true:false
        ),
        array(
            'label'=&gt;'图片管理',
            'url'=&gt;array('/picture'),
            'template'=&gt;'{menu}&lt;span&gt;this is additional infomation&lt;/span&gt;',
            'itemOptions'=&gt;array('class'=&gt;'li_picture'),
            'active'=&gt;$this-&gt;id=='picture'?true:false,
            'visible'=&gt;true
        ),
        array('label'=&gt;'管理员管理',
            'url'=&gt;array('/manager'),
            'itemOptions'=&gt;array('class'=&gt;'li_manager'),
            'submenuOptions'=&gt;array('class'=&gt;'subclass'),
            'active'=&gt;($this-&gt;id=='manager' &amp;&amp; $this-&gt;action-&gt;id!='changepswd')?true:false,
            'visible'=&gt;false
        ),
        array(
            'label'=&gt;'密码修改',
            'url'=&gt;array('/manager/changepswd'),
            'linkOptions'=&gt;array('target'=&gt;'_blank'),
            'itemOptions'=&gt;array(
                'class'=&gt;'li_changepswd'
            ),
            'items'=&gt;array(
                array('label'=&gt;'子栏目')
            ),
            'active'=&gt;($this-&gt;id=='manager' &amp;&amp; $this-&gt;action-&gt;id=='changepswd')?true:false,
            'visible'=&gt;true
        ),
        array(
            'label'=&gt;'登陆',
            'url'=&gt;array('/site/login'),
            'itemOptions'=&gt;array('class'=&gt;'li_login'),
            'visible'=&gt;Yii::app()-&gt;user-&gt;isGuest
        ),
        array(
            'label'=&gt;'退出 ('.Yii::app()-&gt;user-&gt;name.')',
            'url'=&gt;array('/site/logout'),
            'itemOptions'=&gt;array('class'=&gt;'li_login'),
            'visible'=&gt;!Yii::app()-&gt;user-&gt;isGuest
        )
    ),
));
</code>
<strong>说明：</strong>
<!--more-->
1. <code>label</code>：菜单显示的文本，可以加 <code>html</code> 进行修饰，但要将 <code>encodeLabel</code> 参数值设为 <code>false</code></p>

<ol>
  <li>
    <p><code>url</code>：链接地址，若是字符串，则是基于网站根地址的绝对路径，比如网站地址为<code>baidu.com</code>，字符串url设置为<code>article</code>，则最终生成的地址为<code>baidu.com/article</code>，如果设置类型为数组，则效果与<code>createUrl</code>方法一样，比如网址还是<code>baidu.com</code>，设置的数组url为<code>array(detail/article)</code>，则最终生成的地址为<code>baidu.com/?r=detail/article</code>，控制器/方法格式的</p>
  </li>
  <li>
    <p><code>visible</code>：可见，<code>boolean</code>值，当然可以用函数来取值，决定什么情况下隐藏</p>
  </li>
  <li>
    <p><code>active</code>：正在访问，<code>boolean</code>值，如果是<code>true</code>，会在相应<code>li</code>中加入<code>active</code>样式，上面代码用到<code>$this-&gt;id</code>是个很好用的方法</p>
  </li>
  <li>
    <p><code>items</code>：定义子目录，<code>array()</code>，通过样式可定义收缩排列或者鼠标经过时显示子目录</p>
  </li>
  <li>
    <p><code>template</code>：模板，模板中用<code>{menu}</code>来代表替换内容，见上代码</p>
  </li>
  <li>
    <p><code>linkOptions</code>：<code>&lt;a&gt;</code>的属性，可定义<code>class</code>，<code>rel</code>，<code>target</code>等属性，见上代码</p>
  </li>
  <li>
    <p><code>itemOptions</code>：<code>&lt;li&gt;</code>的属性，可定义 <code>class</code>等属性，见上代码</p>
  </li>
  <li>
    <p><code>submenuOptions</code>：子栏目的<code>&lt;ul&gt;</code>属性，<code>&lt;li&gt;</code>和<code>&lt;a&gt;</code>属性还是和上面一样分别对<code>item</code>设置</p>
  </li>
  <li>
    <p><code>activeCssClass</code>：当前选中菜单的Css的<code>Class</code>名称</p>
  </li>
  <li>
    <p><code>firstItemCssClass</code>：第一个菜单按钮的Css的<code>Class</code>名称</p>
  </li>
  <li>
    <p><code>lastItemCssClass</code>：最后一个菜单按钮的Css的<code>Class</code>名称</p>
  </li>
</ol>

<p>当然可以分别为每个Item菜单元素添加指定的<code>Class</code>，即在对应的Item元素上增加<code>itemOptions</code>设置。</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Yii全选删除]]></title>
    <link href="http://blog.forecho.com/Yii-quan-xuan-shan-chu.html"/>
    <updated>2013-05-30T20:10:00+00:00</updated>
    <id>http://blog.forecho.com/Yii-quan-xuan-shan-chu</id>
    <content type="html"><![CDATA[<p>目前功能还是能用，但是删除不是Ajax操作的。等待下次完善。 <strong>Views：</strong></p>

<p>&#8220;`php</p>
<form action="/member/msglog/deleteordmsg" method="post" id="deleteForm">
	<?php
	    $this->widget(&#8216;zii.widgets.CListView&#8217;, array(
	        &#8216;dataProvider&#8217;=>$dataProvider,
	        &#8216;itemView&#8217;=>&#8217;_view&#8217;,
	        &#8216;emptyText&#8217;=>&#8217;暂时没有数据&#8217;,
	       	&#8216;template&#8217;=>&#8217;{items}{pager}&#8217;,
	        &#8216;pager&#8217;=>array(&#8216;class&#8217;=>&#8217;CLinksPager&#8217;),
	        &#8216;itemsTagName&#8217;=>&#8217;table&#8217;,
	        &#8216;itemsOptions&#8217;=>array(&#8216;class&#8217;=>&#8217;list_table&#8217;, &#8216;width&#8217;=>&#8217;100%&#8217;),
	        &#8216;buttonCssClass&#8217;=>&#8217;bg btn_page&#8217;,
	        &#8216;batchItemOptions&#8217;=>array(&#8216;class&#8217;=>&#8221;filter f_l&#8221;),
	        &#8216;batchItem&#8217;=>array(
	            //删除
	            &#8217;<input id="allcheckbox1" onchange="checkAll(\'select-on-check\',\'allcheckbox1\');" class="chk select-on-check" type="checkbox" name="">全选
                 <button class="mem_bgx link_btn mr5" onclick="$(\'#deleteForm\').submit();" title="">删除选中</button>&#8217;			        ),
	    ));
	?>
</form>
<p>&#8220;`</p>

<p><strong>_view.php文件：</strong></p>

<p>&#8220;`html</p>
<tr>
	<td width="6%"><input class="select-on-check chk f_l" type="checkbox" name="ids[]" value="&lt;?php echo $data-&gt;id; ?&gt;" /></td>
    <td width="15%"><?php echo $data->fromMember->name;?></td>
    <td width="58%"><p class="pub_tit02"><?php echo CHtml::link($data->title, array(&#8216;/member/msgLog/inboxDetail&#8217;, &#8216;id&#8217;=>$data->id));?></p></td>
    <td><?php echo date("Y-m-d H:i:m", $data->inputtime);?></td>
</tr>
<p>&#8220;`</p>

<p>*jQuery验证是否有选择：**</p>

<p><code>javascript
&lt;script type="text/javascript"&gt;
//表单验证
$('#deleteForm').bind('submit',function(){
	var data=new Array();
	$("input:checkbox[name='ids[]']").each(function ()
    	{
		if($(this).attr("checked")=='checked')
		{
			data.push($(this).val());
		}
	});
	if(data.length &gt; 0)
	{
	return true;
    }else{
        return false;
    }
})
&lt;/script&gt;
</code></p>

<p><strong>jQuery全选：</strong></p>

<p><code>javascript
/*全选
classs:被选框class
selfid：全选框id
*/
function checkAll(classs,selfid){
	$('.'+classs).attr('checked',$('#'+selfid).attr('checked')?'checked':false);
}
</code></p>

<p><strong>Controller：</strong></p>

<p>&#8220;`php
//删除选中
public function actionDeleteordmsg()
{
	if (Yii::app()-&gt;request-&gt;isPostRequest)
	{
		$criteria= new CDbCriteria;
		$criteria-&gt;addInCondition(‘id’, $_POST[‘ids’]);
		MsgLog::model()-&gt;deleteAll($criteria);</p>

<pre><code>	if(isset(Yii::app()-&gt;request-&gt;isAjaxRequest)) {
		$message = '删除成功。';
		$path = '../index/success';
	} else{
		$message = '删除失败。';
		$path = '../index/error';
	}
}
$this-&gt;render($path,array(
		'message'=&gt;$message,
	)); } ```
</code></pre>
]]></content>
  </entry>
  
</feed>
